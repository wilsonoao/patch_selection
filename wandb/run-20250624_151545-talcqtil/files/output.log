dilated_ratio:  [1, 2, 4, 8, 16]
segment_length:  [1024, 5792, 32768, 185363, 1048576]
Number of trainable LongNet parameters:  85148160
Global Pooling: False
slide_encoder.pth: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 345M/345M [00:31<00:00, 11.1MB/s]
[92m Successfully Loaded Pretrained GigaPath model from hf_hub:prov-gigapath/prov-gigapath [00m
[768, 512, 256]
  0%|                                                                                                       | 0/518 [00:00<?, ?it/s]
embedding safe

Parameter: merge_catmsg_selfatten.to_qkv.weight
tensor([[ 0.0009,  0.0259,  0.0115,  ..., -0.0222,  0.0153,  0.0341],
        [-0.0015,  0.0094, -0.0112,  ...,  0.0012,  0.0299,  0.0085],
        [-0.0124,  0.0003,  0.0339,  ..., -0.0224,  0.0315, -0.0313],
        ...,
        [ 0.0032, -0.0358, -0.0303,  ...,  0.0199,  0.0154,  0.0103],
        [-0.0089,  0.0178,  0.0282,  ..., -0.0048, -0.0035, -0.0193],
        [-0.0192,  0.0010,  0.0055,  ...,  0.0131,  0.0277, -0.0046]],
       device='cuda:0')

Parameter: merge_catmsg_selfatten.to_out.0.weight
tensor([[ 0.0335, -0.0283,  0.0376,  ...,  0.0390, -0.0329,  0.0292],
        [-0.0127,  0.0214,  0.0263,  ..., -0.0295, -0.0175, -0.0207],
        [ 0.0256,  0.0214, -0.0361,  ...,  0.0036, -0.0325,  0.0405],
        ...,
        [ 0.0374,  0.0106,  0.0053,  ..., -0.0151,  0.0170,  0.0260],
        [ 0.0414, -0.0173, -0.0213,  ..., -0.0032, -0.0240,  0.0179],
        [-0.0222, -0.0382, -0.0106,  ..., -0.0397,  0.0269, -0.0321]],
       device='cuda:0')

Parameter: merge_catmsg_selfatten.to_out.0.bias
tensor([-3.6670e-02,  9.9121e-03, -3.9218e-03, -5.2460e-03, -1.2873e-03,
         1.1008e-02,  1.2737e-02,  2.8862e-02, -2.9982e-02,  3.4580e-02,
        -3.7803e-02,  3.6640e-02,  1.2822e-02,  2.7445e-02, -3.4411e-02,
        -4.4100e-02, -5.4435e-03, -4.2922e-02,  4.4086e-02, -1.8480e-02,
         1.6204e-02,  2.4771e-02, -3.5015e-02, -3.4871e-03,  3.4138e-02,
         1.9245e-02, -3.4591e-02,  1.3859e-02,  1.7203e-04, -4.1105e-03,
         5.0181e-03,  2.6622e-02,  3.9170e-02, -4.0227e-02, -3.1768e-02,
        -2.9574e-02, -1.0389e-02, -3.0801e-02, -2.0798e-02, -3.9524e-02,
         9.4562e-03, -2.6459e-02, -1.3191e-03, -2.9691e-02,  2.5218e-02,
        -7.3797e-03,  3.0949e-02, -2.1511e-02,  4.1171e-02,  3.6213e-02,
         1.9600e-02, -2.0401e-02, -2.0931e-02,  1.5891e-02, -1.8045e-02,
        -4.2101e-03,  3.3313e-02, -1.3051e-02, -4.1226e-02, -2.1545e-02,
        -7.4786e-03, -3.9676e-02,  2.9558e-02,  2.9447e-02, -3.6526e-02,
        -9.8303e-03, -1.1403e-02, -2.9812e-02,  1.2893e-03,  3.0910e-02,
         2.6541e-03,  1.2879e-02, -8.3897e-03,  2.7630e-02,  3.8759e-02,
        -2.9548e-03, -1.6519e-02,  4.1326e-02,  1.7779e-02,  4.2587e-02,
         4.0266e-02,  2.7957e-02,  2.9328e-02, -2.0756e-02,  3.4619e-02,
         2.1144e-02, -1.8773e-02, -1.5942e-02, -1.9380e-02, -9.8430e-03,
         4.3134e-02,  2.1618e-02,  3.8992e-02, -7.6497e-04, -3.9541e-02,
        -2.6842e-02, -3.1180e-02,  5.2564e-03,  1.0007e-02, -3.0502e-02,
         3.3473e-02, -3.7078e-02,  3.8238e-02,  2.6451e-02, -4.1275e-02,
         2.9142e-02,  1.8918e-02,  2.0727e-02,  9.2464e-03, -4.2089e-02,
        -5.2264e-03, -5.3273e-03,  3.0306e-02,  2.7125e-02, -2.3760e-02,
         3.2255e-02,  2.2318e-02,  3.7770e-04,  2.3514e-02,  1.4270e-02,
         3.3979e-02, -6.4989e-03,  2.2123e-03,  2.1345e-02, -8.3591e-03,
        -2.3763e-02,  4.2069e-02,  1.5582e-02, -2.9165e-02, -1.3467e-02,
         1.8687e-02, -2.8618e-02, -1.4701e-02,  5.5955e-03,  3.9523e-02,
         1.3734e-02, -2.3029e-02,  2.5039e-02, -3.5245e-02,  2.4983e-02,
         3.0996e-02,  3.8250e-02, -2.7536e-02, -1.7861e-02,  2.1479e-02,
         6.4585e-03, -4.3280e-03,  1.0321e-02,  3.2315e-02,  3.4351e-02,
         1.7653e-03,  1.0719e-02, -2.7625e-02, -3.2017e-02,  7.0883e-03,
        -4.8291e-03, -3.4119e-02, -3.1187e-02, -4.5284e-03,  2.2269e-03,
        -3.0558e-02, -3.7671e-02,  4.0639e-02,  7.1576e-03, -3.7370e-02,
        -7.3611e-03,  2.3762e-02,  2.4015e-02,  3.1633e-02,  4.1052e-02,
        -1.8064e-02, -8.9806e-03,  2.2077e-02, -2.4770e-02,  1.8784e-02,
        -2.6571e-02, -2.1386e-02,  2.1516e-02, -7.8574e-03, -2.1069e-04,
         8.5660e-03,  1.4315e-02,  3.0662e-02,  9.3804e-03,  3.1168e-02,
         3.0851e-02,  4.1247e-02,  4.0939e-02,  6.4528e-03,  2.2167e-03,
        -2.8678e-02, -4.2261e-02,  2.4582e-02, -3.0843e-02,  3.0617e-02,
        -1.3540e-02, -3.3451e-02,  2.5153e-02,  3.5439e-02, -1.1541e-02,
         3.5429e-02, -9.6341e-03,  4.2159e-02,  3.7121e-02, -2.7227e-02,
        -4.6058e-03,  2.3974e-02, -4.3050e-02, -1.8894e-03, -2.2411e-03,
        -1.3967e-02,  3.4373e-03,  9.0330e-03,  4.5182e-03, -2.1924e-02,
         4.0022e-02,  2.8636e-02,  3.8814e-02,  2.9749e-03,  1.5647e-02,
        -7.0385e-03,  3.6035e-02,  2.2117e-02, -3.2015e-02, -2.6052e-02,
         4.3116e-02,  1.2425e-02, -3.4272e-02, -1.3495e-03,  6.7217e-03,
         8.4294e-07,  1.8034e-02,  6.2755e-03, -2.6104e-02, -3.5766e-02,
        -4.5050e-03,  3.8516e-02, -3.8834e-03, -3.8621e-04, -5.1968e-03,
         6.2967e-03,  2.9796e-02,  8.7541e-03,  3.2476e-02,  2.7838e-02,
         1.1915e-02,  1.6676e-02, -1.9384e-02, -5.2081e-03,  1.6417e-03,
         2.7096e-02,  2.6559e-03,  1.9031e-02, -4.2066e-02,  3.1099e-02,
         3.0671e-02,  4.2619e-02,  2.1273e-02, -3.4356e-02,  3.9276e-02,
         4.3381e-03,  3.7691e-02,  3.2217e-02, -4.2523e-02, -4.8698e-03,
         3.9517e-02, -2.1428e-02,  9.1354e-03, -1.6252e-02, -2.8886e-02,
        -6.5485e-03, -4.9190e-03, -4.0905e-03, -2.6716e-02,  1.1725e-02,
        -3.3834e-02, -1.6506e-02, -2.8698e-02, -2.8652e-03, -2.3222e-02,
        -7.1389e-03,  8.6629e-03,  2.6224e-02,  3.8152e-03, -4.3393e-02,
        -1.1881e-02, -2.3591e-02,  4.3268e-02, -3.2491e-02, -3.6213e-02,
        -1.5274e-02,  2.2762e-02,  1.3654e-02, -3.9902e-02,  8.6998e-03,
        -1.0673e-02, -1.8906e-02, -2.6821e-03, -7.4866e-03,  3.1434e-02,
         1.1543e-02, -2.6040e-02, -1.8763e-02, -2.4987e-02,  2.1794e-02,
         3.2606e-02, -3.7171e-02,  4.1084e-02, -3.3583e-02, -3.7583e-02,
         2.7721e-02,  1.6549e-02,  1.7595e-02,  1.9080e-02, -7.2627e-04,
         2.2946e-02, -4.1029e-02, -1.4935e-02,  3.0604e-03,  8.6681e-03,
        -1.9385e-02, -3.0827e-02, -2.9706e-02,  2.2150e-02,  1.8914e-02,
        -3.3738e-02, -3.9650e-02,  1.0058e-02,  8.9096e-03, -3.5413e-02,
         1.0692e-02,  3.9871e-02, -3.7110e-02,  9.0069e-03, -4.0321e-03,
         2.6722e-02, -3.2446e-02, -4.0618e-02,  6.2296e-03,  9.0209e-03,
         2.7175e-02,  1.0728e-02, -2.1654e-02,  6.6939e-03, -2.4391e-02,
         3.9147e-02, -1.9599e-02,  2.9426e-02, -7.8180e-03,  3.4559e-02,
        -4.2057e-02,  3.6359e-02, -2.1362e-02, -3.4365e-02, -3.4623e-02,
         2.7707e-02, -2.1574e-02, -3.8079e-02, -2.8842e-03,  2.4659e-02,
         4.3863e-02, -4.1655e-02, -3.0679e-02, -3.3221e-02, -8.0738e-04,
        -3.5762e-04,  3.5302e-02, -1.5085e-03,  7.3517e-03,  1.9417e-02,
         3.4017e-02,  3.0026e-02, -5.7834e-03, -4.1327e-02, -2.6003e-02,
        -2.8424e-02,  3.8510e-02,  4.3927e-02,  2.8106e-02,  6.9044e-03,
        -8.1761e-03,  3.9282e-02, -1.7161e-02,  1.5139e-04,  3.5279e-02,
        -3.8016e-02,  3.5585e-02, -3.0689e-02,  2.5356e-03,  9.4848e-03,
        -1.7607e-02,  1.8646e-03, -1.8858e-02, -3.9055e-03, -3.0762e-02,
         3.2555e-03, -3.6669e-03, -2.0683e-02, -2.7318e-02, -1.3136e-02,
        -1.6084e-02, -3.0777e-02,  2.5631e-02, -1.5352e-02, -3.0428e-03,
         1.5490e-02, -5.1127e-03,  1.9663e-02,  4.4727e-03, -1.3892e-02,
         2.4577e-03,  2.4301e-02,  4.0138e-02, -4.3556e-02,  3.5664e-02,
         2.0629e-03,  2.0381e-02, -2.4615e-02, -4.3150e-02, -9.4838e-03,
        -1.7339e-02,  2.3711e-02,  4.8026e-03, -3.0383e-02, -2.5277e-02,
        -2.0491e-02,  6.9926e-03, -2.0734e-02, -1.7859e-02,  2.6821e-02,
         1.5214e-02, -2.7037e-02, -1.5150e-03,  3.1683e-02, -1.3572e-02,
         3.6145e-02, -8.0296e-03, -2.7428e-02,  2.6726e-02, -3.8996e-03,
        -3.5236e-02,  8.7891e-03,  3.3719e-02, -3.1325e-02,  1.3550e-02,
        -1.2706e-02,  2.3065e-02,  3.1223e-02,  2.4667e-02, -1.1522e-02,
        -4.3467e-02,  4.7066e-04,  3.4760e-02, -1.0176e-02, -1.0759e-02,
         2.6903e-02,  2.4439e-02,  8.1962e-03, -3.6092e-02, -2.4243e-02,
        -1.2180e-02, -4.3570e-02,  3.1287e-02,  1.6817e-02, -3.0979e-03,
        -1.9109e-02,  1.1327e-03, -3.8068e-02, -1.6202e-02, -7.5318e-03,
         3.5351e-02,  5.1564e-04, -3.0805e-02, -2.5985e-02,  1.2514e-02,
         2.8891e-03,  2.4002e-02, -2.2050e-02, -1.5377e-02, -2.3061e-02,
        -2.7847e-02, -2.9890e-02,  2.3027e-02,  3.3368e-04,  2.5311e-02,
         7.6746e-03,  4.7588e-03,  2.7963e-02, -4.4055e-02,  1.3963e-02,
        -3.0815e-02,  1.2609e-02, -2.8924e-02, -3.1129e-02, -2.8017e-02,
        -8.4787e-04,  3.5373e-02,  4.4452e-03, -1.8188e-02, -2.7980e-02,
         3.3037e-02,  2.6567e-02, -7.1457e-03, -6.3121e-03, -3.6075e-02,
         9.8440e-04,  1.8715e-02, -2.5191e-02,  3.4172e-02,  3.1397e-02,
         3.2383e-02,  1.1842e-02, -3.5603e-02, -7.2964e-03, -3.4137e-02,
         2.1097e-02, -2.0933e-02, -1.5400e-02, -5.5335e-03, -4.2668e-02,
        -2.0006e-02,  1.7388e-02, -4.0354e-02,  6.5241e-03, -2.8245e-02,
         1.6328e-03,  1.6442e-02, -3.1097e-02, -1.6032e-02, -3.4467e-02,
        -1.7252e-02, -8.9080e-03,  5.7532e-03,  1.7226e-03,  3.0596e-02,
        -3.0043e-02,  1.2667e-02, -2.9508e-02, -3.6411e-02, -2.9805e-02,
        -4.0091e-02, -2.1781e-02,  1.8614e-02,  2.1325e-04, -3.4657e-02,
        -1.4329e-02, -2.5814e-02, -2.1099e-02, -2.6317e-02, -2.3767e-02,
         1.1548e-02,  4.0292e-02,  1.6133e-02,  3.0085e-03, -2.6408e-03,
         4.0529e-02, -7.6841e-03,  2.5924e-02,  8.1704e-03,  3.1915e-02,
        -1.2093e-02, -3.7684e-02, -1.7048e-02, -2.6997e-02, -2.4357e-02,
        -6.6665e-03,  1.7675e-02, -3.2674e-03, -3.7025e-02, -5.6931e-03,
        -4.3588e-02, -1.4715e-02,  3.3065e-02,  2.7528e-02,  2.7996e-02,
        -3.9556e-02, -4.1106e-02, -1.6920e-03,  1.4176e-02,  1.8731e-02,
        -1.7334e-02, -2.8634e-02,  1.1243e-02, -1.0147e-03,  1.4606e-02,
         3.6986e-02, -4.0801e-03,  3.2421e-02,  8.8934e-03, -4.3290e-02,
         1.8396e-02, -4.0535e-03, -3.8539e-02, -1.8525e-03, -3.1082e-02,
        -2.1621e-02, -3.7818e-02,  2.1773e-02,  3.8407e-02, -1.3270e-03,
         6.2291e-03,  6.4244e-03, -4.8625e-03,  2.0308e-02, -1.3678e-03,
         2.6477e-02,  3.9578e-03,  2.4409e-03, -3.2100e-02, -2.2640e-02,
        -5.3397e-03,  2.3288e-02,  2.1357e-02,  7.9488e-03,  6.1413e-03,
         3.6524e-02,  3.1963e-02,  4.1755e-02,  3.4385e-02, -1.7181e-02,
         2.5752e-02, -3.7052e-02,  1.4171e-02, -2.5113e-02,  3.0444e-02,
        -2.3363e-02, -4.3474e-02, -6.2389e-03,  4.1797e-02, -1.9456e-02,
        -2.9580e-02, -2.9402e-02, -1.1590e-02,  1.7484e-02, -2.2950e-02,
        -3.7981e-02,  3.1717e-02, -1.8136e-02, -1.5784e-02,  1.9393e-02,
         3.7326e-02, -1.8692e-02, -1.2328e-02,  2.8098e-02, -1.5680e-02,
        -3.7686e-02, -2.7336e-02, -2.7973e-02,  2.5893e-02,  2.9054e-02,
        -2.0183e-02, -3.5041e-03,  3.7128e-02, -1.0041e-02,  2.1648e-03,
         4.0318e-02,  2.5425e-02,  3.0270e-02,  3.3640e-02,  3.6664e-02,
        -7.0442e-03,  2.8068e-02, -3.6324e-02,  2.1588e-02,  2.2065e-02,
        -4.2137e-02,  2.7671e-02,  1.0527e-02,  3.5821e-03,  1.1703e-02,
         1.4199e-02,  4.0502e-02, -4.2050e-04, -3.2691e-02, -3.9434e-02,
        -1.0990e-02, -3.8198e-02, -1.8743e-02, -4.1900e-02,  3.1952e-02,
        -4.2541e-02, -2.1896e-02, -1.7713e-03, -2.6657e-02, -2.3944e-02,
         2.7011e-02,  3.1192e-02,  2.3233e-02,  1.3421e-02,  1.8767e-02,
        -3.1745e-02,  3.8446e-02,  3.6668e-02,  3.6180e-02, -1.8104e-02,
        -1.1413e-02, -2.2375e-02, -3.1886e-02, -1.3973e-02, -1.2145e-03,
        -3.3409e-03,  2.4360e-03,  1.6820e-02, -2.8572e-02, -2.9894e-02,
        -4.1761e-02,  3.2103e-02, -8.0501e-03, -2.3871e-02,  2.8701e-02,
        -2.6776e-02, -4.1273e-02,  2.6131e-02,  3.0430e-02,  1.9548e-02,
         4.0988e-02,  4.1333e-02, -1.1075e-02, -9.0615e-03, -3.7290e-02,
        -2.5755e-02,  2.8709e-02, -3.8516e-02, -2.9934e-02,  2.4042e-03,
        -3.6184e-02,  3.7654e-02, -8.6633e-03, -4.4165e-02, -1.6345e-02,
         2.0868e-02, -4.9399e-03,  5.6549e-03, -1.3779e-03, -4.1909e-02,
         1.8130e-03, -1.6782e-02,  2.0070e-02, -1.7616e-02, -4.3541e-02,
         1.2151e-02,  3.6135e-02, -4.2895e-02, -4.0222e-02,  2.8714e-02,
         3.4030e-02, -1.9402e-02, -1.8943e-02, -3.1799e-02,  4.2297e-02,
        -3.7494e-02, -4.2053e-02, -8.8650e-03,  4.2031e-02, -7.3423e-03,
         6.1894e-03, -3.5550e-02,  2.6116e-02, -4.1624e-02, -1.5834e-03,
        -4.3828e-02,  2.0923e-02, -2.3485e-02,  3.0994e-02,  2.2443e-02,
        -3.7989e-02,  7.1929e-03,  3.7927e-03], device='cuda:0')

Parameter: gru.weight_ih_l0
tensor([[-0.0008, -0.0314, -0.0045,  ..., -0.0035,  0.0290, -0.0352],
        [-0.0355,  0.0281,  0.0076,  ..., -0.0262, -0.0251,  0.0187],
        [-0.0261,  0.0119,  0.0314,  ...,  0.0315, -0.0083,  0.0257],
        ...,
        [ 0.0129, -0.0103,  0.0007,  ...,  0.0049, -0.0161,  0.0020],
        [ 0.0050,  0.0218, -0.0062,  ..., -0.0349,  0.0145, -0.0054],
        [ 0.0146, -0.0190,  0.0271,  ..., -0.0095,  0.0348, -0.0052]],
       device='cuda:0')

Parameter: gru.weight_hh_l0
tensor([[ 0.0129, -0.0219,  0.0258,  ...,  0.0308, -0.0087, -0.0241],
        [ 0.0066, -0.0273, -0.0098,  ...,  0.0266, -0.0215,  0.0086],
        [ 0.0001,  0.0350, -0.0142,  ..., -0.0052,  0.0100, -0.0099],
        ...,
        [-0.0111,  0.0336,  0.0112,  ...,  0.0158, -0.0002,  0.0154],
        [-0.0219, -0.0191, -0.0360,  ..., -0.0243, -0.0341,  0.0124],
        [ 0.0141,  0.0145, -0.0161,  ...,  0.0199, -0.0033, -0.0172]],
       device='cuda:0')

Parameter: gru.bias_ih_l0
tensor([-0.0266, -0.0143,  0.0360,  ..., -0.0058, -0.0154, -0.0336],
       device='cuda:0')

Parameter: gru.bias_hh_l0
tensor([-0.0063,  0.0283, -0.0027,  ...,  0.0324,  0.0266, -0.0048],
       device='cuda:0')

Parameter: actor.0.weight
tensor([[-0.0099,  0.0249,  0.0325,  ...,  0.0279,  0.0249, -0.0223],
        [-0.0058, -0.0149, -0.0199,  ...,  0.0191, -0.0031,  0.0064],
        [ 0.0042,  0.0085, -0.0181,  ...,  0.0032,  0.0035,  0.0032],
        ...,
        [-0.0100,  0.0225, -0.0201,  ...,  0.0064, -0.0055, -0.0228],
        [-0.0256, -0.0047,  0.0291,  ..., -0.0039, -0.0275, -0.0266],
        [ 0.0280, -0.0126, -0.0223,  ..., -0.0023,  0.0091,  0.0137]],
       device='cuda:0')

Parameter: actor.0.bias
tensor([ 0.0218,  0.0217,  0.0185, -0.0079,  0.0330, -0.0306, -0.0033,  0.0280,
         0.0165, -0.0226, -0.0290, -0.0027,  0.0051,  0.0323,  0.0355,  0.0099,
        -0.0213,  0.0214, -0.0253, -0.0215, -0.0033,  0.0201, -0.0078, -0.0130,
        -0.0214,  0.0256,  0.0090,  0.0184,  0.0212,  0.0321], device='cuda:0')

Parameter: critic.0.weight
tensor([[-2.7996e-02,  3.4954e-02,  3.4991e-02, -5.7975e-03,  3.9110e-03,
          2.8644e-02, -3.6740e-03, -1.7689e-02,  2.3755e-02,  3.4711e-02,
          8.5439e-03, -2.2211e-02, -2.2686e-02, -1.4329e-02,  1.3781e-02,
         -1.7301e-03, -2.9665e-02, -2.8401e-02, -1.1546e-02, -3.1042e-02,
          2.2880e-02,  3.5179e-02,  4.7674e-03,  1.4266e-02,  1.3188e-02,
         -7.4685e-03,  1.7545e-02, -6.9892e-03, -3.8035e-03, -2.5271e-02,
          2.4866e-02, -3.2766e-02,  1.0679e-02,  1.9537e-02, -5.4441e-03,
          2.0674e-02, -1.5268e-02, -4.2718e-03, -3.0921e-02, -8.0482e-03,
          2.9083e-02, -3.4771e-02,  1.3936e-02,  3.6082e-02, -9.7593e-03,
          1.7903e-03,  3.1302e-02, -1.3531e-02,  3.3208e-02,  8.2600e-03,
          1.1621e-02, -1.7763e-02,  4.1894e-03,  3.0733e-02,  2.4751e-02,
         -1.5937e-02, -2.9433e-02,  8.8083e-03, -3.1975e-02, -1.4349e-02,
         -2.4573e-03,  3.5421e-03, -2.2928e-02,  1.8775e-02, -2.8950e-02,
          1.7279e-03,  2.3573e-02,  1.5206e-02, -2.3028e-02, -2.2781e-02,
         -1.9654e-02,  7.4523e-03,  1.5708e-02, -2.3306e-02,  2.6924e-02,
          2.9106e-02,  2.9006e-02, -2.0146e-02,  1.5683e-02, -1.9483e-02,
         -8.9270e-03, -3.1360e-02, -2.0548e-02,  2.7043e-02, -1.2011e-02,
         -2.5499e-02, -2.3086e-02, -2.1342e-02, -1.5301e-02, -7.6899e-03,
          1.1863e-02,  1.9132e-02, -3.2655e-02,  3.2396e-02, -9.8569e-04,
         -2.4490e-02,  3.5618e-02,  7.2914e-03, -3.4847e-02,  2.1209e-02,
          3.0352e-02,  1.1575e-02, -5.6328e-03,  3.1457e-02, -2.4954e-02,
          4.7213e-03, -4.4269e-03, -6.9686e-03,  2.8805e-02, -2.8303e-02,
          9.6664e-03,  1.5803e-02, -1.8835e-02, -3.5571e-02,  1.3380e-02,
         -3.2786e-02, -1.0784e-02, -3.1154e-02,  8.8381e-03,  2.0221e-02,
          1.0781e-02,  3.1957e-02, -3.0931e-02,  1.5556e-02, -2.2088e-03,
          1.3621e-02,  2.8446e-02, -3.1327e-02,  2.1827e-02, -2.7802e-02,
          3.8716e-03,  1.3507e-02,  2.3636e-02, -3.0702e-04, -9.9516e-03,
          1.9691e-03, -9.2028e-03,  2.4721e-02,  2.1780e-02, -2.2599e-02,
          1.2981e-02,  1.6195e-02, -2.7471e-02,  1.8887e-02,  1.7192e-02,
          8.7995e-03, -7.9305e-03,  1.4528e-02,  1.4147e-02,  4.6820e-03,
         -1.8706e-02, -1.6189e-02,  3.1394e-02,  2.5334e-02,  1.7137e-02,
         -2.5450e-02, -2.8227e-02, -7.3744e-03, -2.8966e-02,  1.0249e-02,
          2.7550e-02, -2.2478e-02,  1.3090e-02, -1.2931e-02,  1.9741e-02,
          2.3174e-02, -3.0471e-02,  2.1929e-02,  9.0012e-03,  2.1822e-02,
          2.6960e-02,  1.7711e-02, -3.1279e-03, -2.7326e-02,  9.9630e-03,
         -8.1913e-03, -2.9981e-02, -1.8734e-02, -2.1615e-03, -2.5842e-02,
         -5.4185e-03,  1.8383e-02,  2.9732e-02,  1.3328e-02, -1.5351e-02,
          1.1550e-02, -4.1530e-03,  3.1205e-02,  1.3392e-02, -2.1325e-02,
          1.4376e-02, -3.1753e-02,  3.0771e-02,  1.6110e-02, -2.4331e-02,
         -2.3254e-03,  2.5779e-02, -1.6574e-04,  8.4844e-03,  2.6934e-03,
          3.3329e-02, -1.2640e-02, -1.5178e-03, -2.9377e-02, -2.5941e-02,
          3.3014e-02, -2.2660e-02,  2.3393e-02,  2.7526e-02, -2.8992e-02,
         -1.1146e-02, -3.5480e-02, -2.8419e-03, -2.3396e-02,  1.5054e-02,
         -2.1413e-02, -2.7914e-02, -1.2535e-02,  2.1027e-02,  1.4782e-02,
          1.9015e-02, -2.8529e-03, -1.8179e-02, -5.9954e-03, -1.3149e-02,
         -1.2267e-02,  2.7482e-02,  2.1967e-02,  3.4693e-02, -2.7952e-02,
         -1.8356e-02, -3.5635e-02,  9.7442e-03, -1.2814e-03, -3.5632e-02,
          2.1927e-02,  2.2041e-02, -1.4265e-02, -1.0405e-02,  1.1142e-02,
         -8.4905e-03, -7.1829e-03,  2.3986e-02,  2.1975e-02, -3.1320e-02,
          3.4467e-02,  2.2598e-02, -1.4124e-02,  8.1557e-03,  2.6786e-02,
         -8.0999e-03,  1.7993e-02, -3.4788e-02, -2.1257e-02,  3.2179e-02,
          2.9408e-02, -5.5384e-03, -4.3010e-04,  1.2367e-02, -5.2973e-03,
         -2.5940e-02, -1.9630e-02,  2.8056e-02,  1.2409e-03, -2.2240e-02,
          3.1479e-02, -3.5658e-02, -4.6645e-03,  3.5464e-02, -5.7018e-04,
         -2.1112e-02, -2.4379e-02,  3.3162e-03, -1.0437e-02, -3.3666e-02,
         -1.9107e-02, -1.6425e-02,  2.0780e-02, -3.2457e-02,  3.2741e-02,
         -3.1560e-02, -2.4413e-02, -1.1673e-02, -1.9106e-02,  3.1042e-02,
          2.4935e-02,  7.1827e-03, -2.8435e-02,  1.0641e-03,  3.1933e-02,
         -3.1808e-02, -7.6783e-03, -3.0135e-02, -2.6888e-03, -2.4676e-02,
          2.3299e-04, -2.9359e-03, -1.5644e-02,  9.7682e-03, -1.8193e-03,
          1.5633e-02,  2.9985e-02, -3.2535e-02,  9.0557e-03, -2.3203e-02,
          8.5058e-03, -6.0100e-03, -1.9172e-02, -2.8875e-02, -3.4900e-02,
          1.3260e-02,  2.9973e-02,  2.6024e-02,  2.6852e-02,  2.5505e-02,
         -1.0714e-02, -2.7176e-02, -2.6005e-02,  1.6365e-02,  5.7542e-03,
          2.8257e-02, -1.4025e-02,  1.4396e-02,  1.5112e-02,  5.3194e-03,
         -1.6028e-02, -1.8987e-02, -7.6355e-03, -9.3741e-03, -1.8744e-02,
          1.7499e-02, -3.3793e-02,  4.5054e-03, -2.3261e-02,  1.2053e-02,
          1.6058e-04, -3.0972e-02, -2.4104e-03, -2.6098e-02,  2.1740e-02,
         -2.6464e-02, -2.6035e-02, -6.0271e-03, -2.9992e-02, -1.7601e-03,
          2.8015e-02,  9.4586e-03, -1.7333e-02, -2.6885e-02, -2.9422e-02,
         -2.5354e-02,  1.9792e-02,  1.5018e-02,  2.8559e-03,  1.5444e-02,
          1.0458e-02,  2.8962e-02,  7.9314e-03,  5.0245e-03,  7.2614e-03,
          2.1850e-03, -1.1305e-02,  3.4307e-03,  3.1688e-02,  3.3716e-02,
         -8.3590e-03,  2.0551e-02,  1.1557e-02, -2.9298e-02,  2.4553e-02,
          4.0009e-03,  8.5939e-04,  1.1519e-02,  3.2789e-02, -1.1857e-02,
         -3.5070e-02, -2.1405e-02, -2.3581e-02, -2.7755e-03,  1.1392e-02,
          1.4621e-02,  1.8642e-02, -9.5278e-03,  2.7355e-02,  3.7202e-04,
         -2.4588e-02, -2.3957e-02,  2.8677e-02,  2.0370e-02, -1.5879e-02,
          2.9934e-03,  8.8908e-03, -1.0236e-03, -1.8298e-02, -6.7518e-03,
          3.2056e-02,  1.0704e-02, -1.2333e-02, -5.6954e-03,  1.9597e-03,
          8.7427e-03,  2.6605e-02,  4.0634e-03, -4.3285e-03, -1.8104e-02,
         -2.0328e-02, -1.1376e-02,  2.7719e-02,  2.3761e-03, -3.3367e-02,
          1.0839e-02,  2.5681e-02,  8.7614e-03, -2.2506e-02, -5.6985e-03,
         -4.5588e-03,  2.4947e-02,  2.7138e-02, -7.6607e-03,  1.3433e-02,
          1.7477e-02,  4.9147e-03, -1.9079e-02,  7.9781e-03, -2.1687e-02,
         -3.4998e-02,  2.6252e-02,  3.6074e-02,  1.7260e-02,  2.0825e-02,
         -2.5220e-02,  8.7490e-03, -1.1766e-02,  3.4222e-02, -2.9595e-02,
          1.3896e-02, -2.2672e-02, -3.2430e-02, -2.3606e-03,  3.3769e-02,
         -2.6844e-02, -8.7705e-03,  1.7421e-02,  2.9593e-02, -3.3034e-02,
         -1.2691e-02, -2.5233e-02,  2.5279e-02, -2.8764e-02, -2.6488e-02,
          2.4146e-02,  1.7405e-03, -2.2540e-02, -3.1108e-02,  3.1285e-02,
         -3.7817e-03, -8.5435e-03, -1.9876e-02, -3.4837e-02, -2.6167e-02,
          1.9859e-02,  2.3778e-02,  1.3537e-03,  3.0374e-02, -2.3570e-02,
          1.7867e-02,  6.6145e-04, -1.9166e-02, -2.7910e-02,  4.0876e-03,
          2.3408e-02,  2.3876e-03, -3.5801e-03,  8.4768e-03, -2.8493e-02,
         -1.7497e-02,  3.0830e-02,  1.2061e-02, -3.5712e-03, -2.8747e-02,
         -2.2511e-02,  1.7179e-02,  1.3997e-02, -3.3449e-02,  7.4900e-03,
          3.5475e-02,  1.3596e-02,  1.3742e-02,  1.5127e-02,  1.9711e-02,
          5.3373e-04, -2.2620e-03,  1.5114e-02,  1.8274e-02,  2.4831e-02,
          2.1509e-02,  7.3439e-03,  7.1584e-03,  2.1254e-02,  3.5531e-03,
          8.0956e-05,  1.2668e-02,  7.1760e-04, -2.5481e-02,  8.0332e-03,
         -1.3661e-02,  1.5775e-02, -1.1098e-02,  1.5144e-02,  2.9398e-02,
          6.9197e-03,  1.7582e-02, -3.0150e-02, -1.2825e-02, -2.4593e-02,
         -1.2837e-02,  1.2734e-02, -1.6692e-02, -6.8435e-03, -7.3937e-03,
          1.4675e-02, -1.6767e-02,  3.3891e-02,  3.4329e-02,  2.9313e-02,
          9.2155e-03, -1.7237e-03, -3.5130e-03,  8.7242e-03, -2.3844e-02,
         -1.1271e-02, -1.7941e-02, -2.0036e-02, -3.5167e-02,  1.6193e-03,
          3.1848e-02, -5.2432e-03,  2.6886e-02, -9.3225e-03, -2.4739e-02,
         -3.3773e-02,  2.4257e-02, -3.4372e-03, -1.2267e-02, -3.8566e-03,
         -3.1847e-02, -8.4547e-03,  2.1983e-02,  1.1952e-03, -6.3509e-03,
          9.8481e-03, -2.6243e-02, -1.7363e-02, -2.4784e-02,  1.2156e-02,
         -2.9103e-02,  1.4597e-02, -2.6329e-02, -3.5140e-02, -2.9475e-02,
         -2.6104e-02,  1.0829e-02,  3.7009e-03,  2.8959e-02,  1.2755e-02,
         -2.8979e-02,  3.1602e-02,  9.7432e-03,  1.9834e-02,  7.8380e-04,
          1.4271e-02,  2.6588e-02, -3.1823e-02,  2.9348e-02, -5.6937e-03,
          2.1985e-02,  1.4356e-02,  1.9169e-02, -3.1303e-02, -1.3453e-02,
          1.6160e-02, -6.6032e-03, -3.2587e-02,  2.4611e-02,  1.1152e-03,
          2.2956e-02, -1.6368e-02,  1.8652e-02,  1.7994e-02,  2.3983e-02,
         -3.1165e-02,  2.7481e-02, -1.6148e-02,  2.7702e-02,  5.0779e-03,
          1.3327e-02,  9.5342e-03,  1.8662e-02,  2.4856e-04,  1.2839e-02,
         -2.0531e-03,  1.8577e-02,  6.4921e-03,  2.8531e-02, -5.5723e-03,
          1.4020e-02,  7.3464e-03,  2.7186e-02, -2.6178e-03,  6.5110e-03,
         -2.8525e-02,  2.6042e-02, -3.0669e-02,  3.3720e-02, -2.7698e-02,
         -3.1671e-02, -2.2930e-02, -2.5261e-02,  3.2809e-02,  4.7033e-03,
         -1.2994e-02,  1.0120e-02, -3.1747e-03,  2.4366e-02, -2.1301e-02,
          1.0671e-02, -2.8665e-02, -1.2495e-02,  2.9249e-02,  2.3935e-02,
          2.6342e-02, -2.1232e-02,  2.6856e-02,  1.4617e-02, -1.1282e-02,
          1.6103e-02, -7.9266e-03, -3.2261e-02,  3.3234e-03,  3.5227e-02,
         -2.4374e-02, -1.2344e-02,  7.1888e-03, -1.8793e-02,  2.8591e-02,
          9.3961e-03, -5.2078e-03,  7.4979e-03, -1.9208e-02, -1.3115e-02,
         -3.1721e-02,  2.6274e-03, -3.0138e-03,  2.6179e-02, -3.2866e-02,
          2.1275e-02,  9.9994e-03, -1.7484e-02, -1.5552e-02, -1.7170e-02,
          4.2189e-03,  9.9743e-03, -3.2960e-03, -3.1705e-02, -2.2054e-02,
         -1.1968e-02,  1.3175e-02, -9.1250e-03, -1.0477e-02,  3.4413e-02,
          2.8911e-02, -1.4907e-02,  7.2372e-04,  3.1295e-02, -1.7230e-02,
          2.8946e-02, -3.1647e-04, -3.3893e-02, -1.0091e-02,  3.2331e-02,
         -2.2069e-02,  2.6325e-02,  1.6454e-02,  3.0585e-02,  1.0964e-02,
         -2.9071e-03,  4.9476e-03,  3.0175e-02,  1.2806e-02, -4.9501e-03,
          1.8834e-02, -2.3518e-02, -1.1581e-02,  1.2994e-02, -7.9587e-03,
         -2.5701e-02, -2.5747e-02, -1.1351e-02,  3.0352e-02, -1.3652e-02,
         -2.7461e-05, -2.6347e-02,  9.2986e-03, -3.0862e-02,  6.3897e-03,
         -7.8311e-04,  1.6245e-02,  2.2402e-02, -3.4283e-02, -5.5680e-03,
         -2.9327e-02, -1.0235e-02,  4.9169e-03, -1.3856e-02,  3.5735e-02,
         -3.2440e-02,  2.4289e-02,  1.2391e-02,  3.4167e-02,  1.2338e-03,
          9.1628e-03,  1.4254e-02, -2.0706e-03,  2.3346e-02, -2.7377e-02,
         -1.3039e-02, -2.0012e-02, -2.6698e-02, -3.3199e-02, -2.8250e-02,
          1.5567e-02,  2.8169e-02, -6.9493e-03, -1.1004e-03,  3.1912e-02,
          3.2058e-03,  2.9204e-02, -4.3398e-03, -2.3106e-02, -5.0372e-03,
          4.0748e-03,  1.7088e-02, -3.1535e-02, -3.0889e-02, -1.3517e-02,
          1.9827e-02, -2.9531e-02, -1.0952e-02, -1.0383e-03, -3.2809e-03,
         -2.6806e-02,  5.7950e-03, -4.0792e-03, -2.5941e-02, -3.3155e-02,
          3.4750e-02, -3.1720e-02,  1.6186e-02, -5.5928e-03,  1.3172e-02,
          3.5176e-02, -1.7132e-02,  2.2157e-02,  1.1324e-02,  3.4918e-02,
         -2.5355e-04,  7.2248e-03, -2.2743e-02]], device='cuda:0')

Parameter: critic.0.bias
tensor([0.0163], device='cuda:0')
Clipped grad norm: nan
Traceback (most recent call last):
  File "/work/PAMIL_two_round/train.py", line 88, in <module>
    main(args)
  File "/work/PAMIL_two_round/train.py", line 81, in main
    train(args,basedmodel,ppo,classifier_chief, classifier_giga,FusionHisF, gigapath_model, memory,train_dataloader, validation_dataloader, test_dataloader, wandb)
  File "/work/PAMIL_two_round/utilmodule/core.py", line 357, in train
    ppo.update(memory)
  File "/work/PAMIL_GIGAPATH_CHIEF/models/DPSF.py", line 238, in update
    logprobs, state_values, dist_entropy = self.policy.evaluate(old_msg_states, old_actions)
  File "/work/PAMIL_GIGAPATH_CHIEF/models/DPSF.py", line 172, in evaluate
    dist = torch.distributions.multivariate_normal.MultivariateNormal(action_mean, scale_tril=cov_mat)
  File "/opt/conda/lib/python3.10/site-packages/torch/distributions/multivariate_normal.py", line 150, in __init__
    super().__init__(batch_shape, event_shape, validate_args=validate_args)
  File "/opt/conda/lib/python3.10/site-packages/torch/distributions/distribution.py", line 62, in __init__
    raise ValueError(
ValueError: Expected parameter loc (Tensor of shape (1, 30)) of distribution MultivariateNormal(loc: torch.Size([1, 30]), scale_tril: torch.Size([1, 30, 30])) to satisfy the constraint IndependentConstraint(Real(), 1), but found invalid values:
tensor([[nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
         nan, nan, nan, nan, nan, nan]], device='cuda:0',
       grad_fn=<ExpandBackward0>)
