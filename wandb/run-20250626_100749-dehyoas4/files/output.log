dilated_ratio:  [1, 2, 4, 8, 16]
segment_length:  [1024, 5792, 32768, 185363, 1048576]
Number of trainable LongNet parameters:  85148160
Global Pooling: False
slide_encoder.pth: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345M/345M [00:33<00:00, 10.4MB/s]
[92m Successfully Loaded Pretrained GigaPath model from hf_hub:prov-gigapath/prov-gigapath [00m
[768, 512, 256]
 12%|███████████████████▎                                                                                                                                           | 63/518 [00:02<00:21, 21.12it/s]
ppo update
🔍 rewards: tensor([0.2199, 0.3556, 0.6715, 0.4246, 0.5879, 0.5348, 0.4691, 0.4839, 0.4811,
        0.5246, 0.5453, 0.5592, 0.5347, 0.5905, 0.5075, 0.6360, 0.5008, 0.6567,
        0.6515, 0.6595, 0.4006, 0.6883, 0.6517, 0.3964, 0.6906, 0.3799, 0.4197,
        0.7353, 0.6919, 0.7181, 0.4605, 0.6532, 0.4085, 0.4304, 0.6741, 0.6662,
        0.5163, 0.4854, 0.4794, 0.5408, 0.6067, 0.4965, 0.6355, 0.6529, 0.3805,
        0.6331, 0.6570, 0.4247, 0.7265, 0.6436, 0.2850, 0.3489, 0.3477, 0.4536,
        0.3752, 0.5505, 0.5217, 0.5836, 0.5625, 0.4930, 0.6245, 0.4441, 0.6841,
        0.6377], device='cuda:0')
rewards.shape: torch.Size([64])
rewards mean: 0.5383012890815735
rewards std: 0.1205616444349289
any NaN in rewards: False
torch.Size([64, 1, 30])
Traceback (most recent call last):
  File "/work/PAMIL_two_round/train.py", line 88, in <module>
    main(args)
  File "/work/PAMIL_two_round/train.py", line 81, in main
    train(args,basedmodel,ppo,classifier_chief, classifier_giga,FusionHisF, gigapath_model, memory,train_dataloader, validation_dataloader, test_dataloader, wandb)
  File "/work/PAMIL_two_round/utilmodule/core.py", line 351, in train
    ppo.update(memory)
  File "/work/PAMIL_two_round/models/DPSF.py", line 273, in update
    logprobs, state_values, dist_entropy = self.policy.evaluate(old_msg_states, old_actions)
  File "/work/PAMIL_two_round/models/DPSF.py", line 207, in evaluate
    return action_logprobs.view(seq_l, batch_size), \
RuntimeError: shape '[64, 1]' is invalid for input of size 4096
