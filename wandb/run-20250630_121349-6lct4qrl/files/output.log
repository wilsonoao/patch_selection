dilated_ratio:  [1, 2, 4, 8, 16]
segment_length:  [1024, 5792, 32768, 185363, 1048576]
Number of trainable LongNet parameters:  85148160
Global Pooling: False
slide_encoder.pth: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345M/345M [00:32<00:00, 10.6MB/s]
[92m Successfully Loaded Pretrained GigaPath model from hf_hub:prov-gigapath/prov-gigapath [00m
[768, 512, 256]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 518/518 [00:57<00:00,  8.96it/s]
precision: 0.6616541353383458
recall: 0.7810650887573964
auc: 0.5164365548980934
accuracy: 0.5965250965250966
f1: 0.7164179104477612
confusion matrix:
[[ 45 135]
 [ 74 264]]
precision: 0.6616541353383458
recall: 0.7810650887573964
auc: 0.5164365548980934
accuracy: 0.5965250965250966
f1: 0.7164179104477612
confusion matrix:
[[ 45 135]
 [ 74 264]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 258/258 [00:08<00:00, 30.33it/s]
precision: 0.5775193798449613
recall: 1.0
auc: 0.4883935718243951
accuracy: 0.5775193798449613
f1: 0.7321867321867321
confusion matrix:
[[  0 109]
 [  0 149]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 258/258 [00:08<00:00, 30.16it/s]
precision: 0.5486381322957199
recall: 1.0
auc: 0.5380372188882827
accuracy: 0.5503875968992248
f1: 0.7085427135678392
confusion matrix:
[[  1 116]
 [  0 141]]
Save model at epoch 0.
val auc: 0.4883935718243951
 64%|███████████████████████████████████████████████████████████████████████████████████████████▍                                                    | 329/518 [00:35<00:20,  9.22it/s]
Traceback (most recent call last):
  File "/work/PAMIL_two_round/train.py", line 88, in <module>
    main(args)
  File "/work/PAMIL_two_round/train.py", line 81, in main
    train(args,basedmodel,ppo,classifier_chief, classifier_giga,FusionHisF, gigapath_model, memory,train_dataloader, validation_dataloader, test_dataloader, wandb)
  File "/work/PAMIL_two_round/utilmodule/core.py", line 342, in train
    giga_loss += loss_giga.item()
KeyboardInterrupt
