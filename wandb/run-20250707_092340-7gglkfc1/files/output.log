dilated_ratio:  [1, 2, 4, 8, 16]
segment_length:  [1024, 5792, 32768, 185363, 1048576]
Number of trainable LongNet parameters:  85148160
Global Pooling: False
slide_encoder.pth: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 345M/345M [00:40<00:00, 8.62MB/s]
[92m Successfully Loaded Pretrained GigaPath model from hf_hub:prov-gigapath/prov-gigapath [00m
[768, 512, 256]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 518/518 [00:41<00:00, 12.39it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████▏                                                           | 150/258 [00:12<00:09, 11.99it/s]
Traceback (most recent call last):
  File "/work/PAMIL_two_round/train.py", line 88, in <module>
    main(args)
  File "/work/PAMIL_two_round/train.py", line 81, in main
    train(args,MoE,ppo,classifier_chief, classifier_giga,FusionHisF, gigapath_model, memory,train_dataloader, validation_dataloader, test_dataloader, wandb)
  File "/work/PAMIL_two_round/utilmodule/core.py", line 466, in train
    precision, recall, f1, val_auc, val_accuracy = test(args,ppo,classifier_chief, classifier_giga,memory,test_loader, chief_model, gigapath_model, run_type="val", epoch=epoch, wandb=wandb)
  File "/work/PAMIL_two_round/utilmodule/core.py", line 41, in test
    update_coords, update_chief_data, update_gigapath_data, label = coords.to(device), chief_data.to(device), gigapath_data.to(device), label.to(device).long()
KeyboardInterrupt
